lm(child~parent,galton)
lm
swirl()
lm(child~1,galton)
head(tress)
head(trees)
fit <- lm(Volume ~
| Girth + Height + Constant -1, trees)
fit <- lm(Volume ~
Girth + Height + Constant -1, trees)
trees2 <- eliminate("Girth", trees)
head(tree2)
head(trees2)
fit2
<- lm(Volume ~ Height + Constant -1, trees2)
fit2<- lm(Volume ~ Height + Constant -1, trees2)
lapply(list(fit, fit2), coef)
lm(Fertility~.,swiss)
all<-lm(Fertility~.,swiss)
summary(all)
summary(lm(Fertility~Agriculture-1,swiss))
summary(lm(Fertility~Agriculture,swiss))
cor(Education,Examination,swiss)
cor(swiss$Education,swiss$Examination)
cor(swiss$Education,swiss$Agriculture)
makelms
makelms()
ec<-sum(swiss$Examination,swiss$Catholic)
ec<-swiss$Examination+swiss$Catholic
efit<-lm(Fertility~.+ec,swiss)
swirl()
play()
ec
head(swiss$Examination)
head(swiss$Education)
ec<-swiss$Examination + swiss$Education
ec
efit<-lm(Fertility~.+ec,swiss)
nxt()
efit<-lm(Fertility~.+ec,swiss)
ec<-swiss$Examination + swiss$Education
swirl()
library(swirl)
swirl()
ec
swirl()
efit<-lm(Fertility~.+ec,swiss)
ec<-swiss$Examination + swiss$Education
swirl()
makelms
library(swirl)
swirl()
ec
swirl()
exit()
quit()
head(mtcars)
?mtcars
rowlength(mtcars)
rows(mtcars)
rowSums(mtcars)
head(mtcars)
swirl()
library(swirl)
swirl()
nxt()
all<-lm(Fertility~.,swiss)
summary(all)
lm(Fertility~Agriculture,swiss)
summary(lm(Fertility~Agriculture,swiss))
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms()
ec <- swiss$Examination + swiss$Catholic
efit <- lm(Fertility ~ . + ec,swiss)
all$coefficients - efit$coefficients
quit()
library(swirl)
swirl()
ec <- swiss$Examination + swiss$Catholic
swirl()
exit()
stop()
quit()
head(mtcars)
lm(mpg ~ .,mtcars)
summary(lm(mpg ~ .,mtcars))
summary(lm(mpg ~ am,mtcars))
summary(lm(mpg ~ am+wt,mtcars))
summary(lm(mpg ~ wt,mtcars))
?mtcars
summary(lm(mpg ~ cyl,mtcars))
summary(lm(mpg ~ disp,mtcars))
summary(lm(mpg ~ hp,mtcars))
summary(lm(mpg ~ drat,mtcars))
summary(lm(mpg ~ qsec,mtcars))
summary(lm(mpg ~ vs,mtcars))
summary(lm(mpg ~ gear,mtcars))
summary(lm(mpg ~ carb,mtcars))
runif(10)
runif(5)
swirl()
library(swirl)
swirl()
quit()
library(swirl)
swirl()
fit <- lm(y ~ x, out2)
plot(fit, which=1)
fitno <- lm(y ~ x, out2[-1,])
plot(fit, which=1)
plot(fitno, which=1)
fit$coef-fitno$coef
play()
fit$coef
fitno$coef
head(dfbeta(fit))
plot(fit)
nxt()
head(dfbeta(fit))
resno <- out2[1, "y"] - predict(fitno, out2[1,])
1-resid(fit)[1]/resno
head(hatvalues(fit))
sigma<-deviance(fit)/df(it)
sigma<-deviance(fit)/df(fit)
sigma<-deviance(fit)/df(fit)$df1
sigma<-deviance(fit)/fit$df1
sigma <- sqrt(deviance(fit)/df.residual(fit))
rstd<-resid(fit)/(sigma*sqrt(1-hatvalues(fit)))
head(cbind(rstd, rstandard(fit)))
head(cbind(rstd, rstandard(fit)))
plot(fit, which=3)
plot(fit, which=2)
sigma1 <- sqrt(deviance(fitno)/df.residual(fitno))
resid(fit)[1]/(sigma*sqrt(1-hatvalues(fit)[1]))
resid(fit)[1]/(sigma1*sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
dy<-predict(fitno, out2)-predict(fit, out2)
dy/2*sigma^2
sum(dy^2)/(2*sigma^2)
plot(fit, which=5)
rgp1()
rgp2()
head(swiss)
mdl<-lm(Fertility~.,swiss)
vif(mdl)
mdl2<-lm(Fertility~. - Examination,swiss)
vif(mdl2)
x1c<-simbias()
apply(x1c, 1, mean)
fit1<-lm(Fertility~Agriculture,swiss)
fit1<-lm(Fertility~Agriculture+Examination+Education,swiss)
fit3<-lm(Fertility~Agriculture+Examination+Education,swiss)
anova(fit1, fit3)
deviance(fit3)
d<-deviance(fit3)/43
n<-(deviance(fit1)-deviance(fit3))/2
n/d
pf(n/d, 2, 43, lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1, fit3, fit5, fit6)
quit()
lm(mpg~cyl+wt,mtcars)
head(mtcars)
summary(lm(mpg~cyl+wt,mtcars))
class(mtcars$cyl)
class(mtcars$cyl)<-as.factor
class(mtcars$cyl)<-as.factor(mtcars$cyl)
class(mtcars$cyl)
summary(lm(mpg~cyl+wt,mtcars))
head(mtcars)
class(mtcars$cyl)
?as.factor
class(mtcars$cyl)<-as.factor(mtcars$cyl,levels)
class(mtcars$cyl)<-as.numeric(mtcars$cyl)
class(mtcars$cyl)<-as.factor(mtcars$cyl,levels)
class(mtcars$cyl)
summary(lm(mpg~cyl+wt,mtcars))
head(mtcars)
class(mtcars$am)
quit()
class(mtcars)
summary(mtcars)
sapply(mtcars,class)
class(mtcars$cyl)<-as.character(mtcars$cyl)
sapply(mtcars,class)
lm(mpg~cyl+wt,mtcars)
summary(lm(mpg~cyl+wt,mtcars))
summary(lm(mpg~cyl+wt-1,mtcars))
summary(lm(mpg~wt[cyl="4"]+wt[cyl="6"]+wt[cyl="8"]-1,mtcars))
summary(lm(mpg~I(1*(cyl=="4"))+I(1*(cyl=="6"))+I(1*(cyl="8"))+wt,mtcars))
summary(lm(mpg~I(1*(cyl=="4"))+I(1*(cyl=="6"))+I(1*(cyl=="8"))+wt,mtcars))
summary(lm(mpg~I(1*(cyl=="4"))+I(1*(cyl=="8"))+wt,mtcars))
summary(lm(mpg~wt(cyl=="4")+wt(cyl=="8"),mtcars))
summary(lm(mpg~wt[cyl=="4"]+wt[cyl=="8"],mtcars))
summary(lm(mpg[cyl=="4"]~wt[cyl=="4"],mtcars))
summary(lm(mpg[cyl=="8"]~wt[cyl=="8"],mtcars))
summary(lm(mpg~I(1*(cyl=="4"))+I(1*(cyl=="8"))+wt,mtcars))
summary(lm(mpg~I(1*(cyl=="4"))+I(1*(cyl=="8")),mtcars))
noint<-lm(mpg~cyl+wt,mtcars)
int<-lm(mpg~cyl*wt,mtcars)
Irtest
lrtest
library(lmtest)
install.packages("lmtest")
library(lmtets)
library(lmtest)
lrtest(noint,int)
class(mtcars$cyl)
noint<-lm(mpg~as.factor(cyl)+wt,mtcars)
int<-lm(mpg~as.factor(cyl)*wt,mtcars)
lrtest(noint,int)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
xy<-lm(y~x)
plot(xy)
hatvalues(xy)
dfbeta(xy)
summary(xy)
dfbetas(xy)
head(mtcars)
?mtcars
head(mtcars[am=="1"])
head(mtcars[am==1])
head(mtcars[mtcar$am=="1"])
head(mtcars[mtcars$am=="1"])
lm(mpg~.,mtcars)
summary(lm(mpg~.,mtcars))
summary(lm(mpg~.-1,mtcars))
?rbinom
View(mtcars)
?mtcars
mtcars[1,1]
mtcars[,2] <- as.factor(mtcars[,2])
mtcars[,8:11] <- as.factor(mtcars[,8:11])
cols = c(2, 8, 9, 10, 11)
mtcars[,cols] = apply(mtcars[,cols], 2, function(x) as.factor(x))
class(mtcars)
View(mtcars)
class(mtcars$gear)
class(mtcars$cyl)
class(mtcars$vs)
class(mtcars$wt)
summary(lm(mpg~.-1,mtcars))
summary(step(lm(data=mtcars, mpg~.), direction="backward"))
library(swirl)
swirl
swirl()
exit
quit()
head(glaton)
head(galton)
library(galton)
library(MASS)
head(galton)
library(datasets
)
head(galton)
library(HistData)
library(Histdata)
install.packages("HistData")
library(HistData)
head(galton)
library(galton)
data(galton)
data(Galton)
head(Galton)
Galton[,1]
Galton[,1]<-Galton[,1]-mean(Galton[,1])
head(Galton)
Galton[,2]<-Galton[,2]-mean(Galton[,2])
lm(child~parent,Galton)
lm(child~parent-1,Galton)
swirl()
library(swirl)
swril()
swirl()
dim(hubger)
dim(hunger)
948
names(hunger)
fit<-lm(Numeric~Year,hunger)
summary(fit)$coef
lmf<-lm(Numeric[hunger$Sex=="Female"]~Year[hunger$Sex=="Female"],hunger)
lmf<-lm(Numeric[hunger$Sex=="Female"]~Year[hunger$Sex=="Female"])
lmf<-lm(hunger$Numeric[hunger$Sex=="Female"]~hunger$Year[hunger$Sex=="Female"])
lmF<-lm(hunger$Numeric[hunger$Sex=="Female"]~hunger$Year[hunger$Sex=="Female"])
lmM<-lm(hunger$Numeric[hunger$Sex=="Male"]~hunger$Year[hunger$Sex=="Male"])
bye()
sapply(mtcars,class)
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars[,2]<-as.factor(mtcars[,2])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars[,8]<-as.factor(mtcars[,8])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars[,8]<-as.integer(mtcars[,8])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fi)
summary(fit)
mtcars[,8]<-as.characters(mtcars[,8])
mtcars[,8]<-as.character(mtcars[,8])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
sapply(mtcars,class)
head(mtcars)
mtcars[,9]<-as.character(mtcars[,9])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars[,2]<-as.character(mtcars[,2])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars[,10]<-as.character(mtcars[,10])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars[,11]<-as.character(mtcars[,11])
fit<-lm(mpg~factor(am)*.-1,mtcars)
summary(fit)
mtcars0<-subset(mtcars,mtcars$am=="0")
mtcars1<-subset(mtcars,mtcars$am=="1")
fit0<-lm(mpg~.-1,mtcars0)
head(mtcars)
head(mtcars0)
fit0<-lm(mpg~.-am -1,mtcars0)
fit0<-lm(mpg~.-am,mtcars0)
fit0<-lm(mpg~.-am,mtcars)
summary(fit0)
mtcars0<-mtcars0[,-9]
head(mtcars0)
fit0<-lm(mpg~.-1,mtcars0)
mtcars1<-mtcars1[,-9]
fit1<-lm(mpg~.-1,mtcars1)
summary(fit)coef
summary(fit)$coef
summary(fit0)$coef
head(fit0)
head(mtcars0)
summary(fit)$coef
summary(fit0)$coef
summary(fit)$coef
summary(fit)$coef
summary(fit1)$coef
head(fit1)
head(mtcars1)
fit1<-lm(mpg~.-1,mtcars1)
summary(fit1)$coef
head(mtcars1)
head(mtcars0)
mtcars0<-subset(mtcars,mtcars$am=="0")
mtcars1<-subset(mtcars,mtcars$am=="1")
names(mtcars0)
mtcars0<-mtcars0[,-9]
mtcars1<-mtcars1[,-9]
names(mtcars0)
mtcars[,c(2,8:10)]<-as.factor(mtcars[,c(2,8:10)])
col<-c(2,8:10)
mtcars[,col]<-as.factor(mtcars[,col])
mtcars[,col]<-apply(mtcars0, function(x) as.factor(x)
)
mtcars[,col]<-apply(mtcars0[,col],2, function(x) as.factor(x))
col<-c(2,8,9,10)
mtcars[,col]<-apply(mtcars0[,col],2, function(x) as.factor(x))
mtcars0[,col]<-apply(mtcars0[,col],2, function(x) as.factor(x))
mtcars1[,col]<-apply(mtcars1[,col],2, function(x) as.factor(x))
head(mtcars1)
head(mtcars0)
fit1<-lm(mpg~.-1,mtcars1)
summary(fit1)$coef
fit1.rm<-lm(mpg~1,mtcars1)
add1(fit1.rm,mtcars1,test='F')
fit1.rm<-lm(mpg~wt,mtcars1)
add1(fit1.rm,mtcars1,test='F')
fit1.rm<-lm(mpg~wt+qsec,mtcars1)
add1(fit1.rm,mtcars1,test='F')
fit0.rm<-lm(mpg~1,mtcars0)
add1(fit0.rm,mtcars0,test='F')
fit0.rm<-lm(mpg~wt,mtcars0)
add1(fit0.rm,mtcars0,test='F')
fit0.rm<-lm(mpg~wt+qsec,mtcars0)
add1(fit0.rm,mtcars0,test='F')
summary(fit0)$coef
summary(fit0.rm)$coef
summary(fit1.rm)$coef
swirl()
bye()
swirl()
dim(hunger)
948
names(hunger)
fit<-lm(Numeric~Year,hunger)
summary(fit)$coef
lmF<-lm(Numeric[Sex=="Female"]~Year[Sex=="Female"],hunger)
lmM<-lm(Numeric[Sex=="Male"]~Year[Sex=="Male"],hunger)
lmBoth<-lm(Numeric~Year+Sex,hunger)
summary(lmBoth)
lmBoth<-lm(Numeric~Year+Sex+Sex*Year,hunger)
lmInter<-lm(Numeric~Year+Sex+Sex*Year,hunger)
summary(lmInter)
head(mtcars)
sapply(mtcars,class)
pairs(mtcars)
pairs(mtcars,smooth=TRUE)
warnings()
pairs(mtcars,lm=TRUE)
warnings()
pairs(mtcars,pch=1)
pairs(mtcars,pch=2)
pairs(mtcars,pch=3)
pairs(mtcars,pch=4)
pairs(mtcars,pch=5)
pairs(mtcars,pch=6)
pairs(mtcars,pch=20)
sapply(mtcars,class)
mtcars.rm<-lm(mpg~factor(am)*.,mtcars)
summary(mtcars.rm)
add1(mtcars.rm,mtcars,test='F')
sapply(mtcars,class)
mtcars.rm<-lm(mpg~factor(am)*.,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-cyl,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs-drat-factor(am):drat,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs-hp-factor(am):hp,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs-wt-factor(am):wt,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs-qsec-factor(am):qsec,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs-carb-factor(am):carb,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs-disp-factor(am):disp,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.-factor(am):cyl-cyl-vs-factor(am):vs,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*cyl+factor(am)*disp+factor(am)*hp+factor(am)*drat+factor(am)*wt+factor(am)*qsec+factor(am)*carb+factor(am)*vs+factor(am)*gear+,mtcars)
mtcars.rm<-lm(mpg~factor(am)*cyl+factor(am)*disp+factor(am)*hp+factor(am)*drat+factor(am)*wt+factor(am)*qsec+factor(am)*carb+factor(am)*vs+factor(am)*gear,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*.,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*wt+factor(am)*carb+factor(am)*qsec,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*wt+factor(am)*qsec,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am)*wt+factor(am)*carb,mtcars)
summary(mtcars.rm)
mtcars.rm<-lm(mpg~factor(am):wt+factor(am):carb+factor(am):qsec,mtcars)
summary(mtcars.rm)
par(mfrow = c(2,2)
plot(mtcars.rm)
par(mfrow = c(2,2))
plot(mtcars.rm)
library(knitr)
pandoc("cars.html",pdf)
render
cols=c(2,8:11)
mtcars[,col]<-apply(mtcars[,cols],2,function(x) as.factor(x))
mtcars[,cols]<-apply(mtcars[,cols],2,function(x) as.factor(x))
sapply(mtcars,class)
rm<-lm(mpg~factor(am)*.,mtcars)
summary(rm)$coef
add1(rm,mtcars,test='F')
summary(rm)$coef
summary(rm)
rm<-lm(mpg~factor(am)*.-factor(am):vs-factor(am):am-factor(am):gear-factor(am):carb-am1,mtcars)
rm<-lm(mpg~factor(am)*.-factor(am):vs-factor(am):am-factor(am):gear-factor(am):carb-am,mtcars)
summary(rm)
add1(rm,mtcars,test='F')
summary(rm)
add1(rm,resid(rm),test='F')
head(resid(rm))
resid(rm)
setwd(E:/R/Shiny)
setwd(E:\R\Shiny)
setwd("E:\R\Shiny")
setwd("E:/R/Shiny")
runApp()
library(Shiny)
library(shiny)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.packages('devtools')
install.packages('devtools')
